<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Haber Blogu - Başlıklar</title>
  <link rel="icon" href="pixilart-drawing.png" type="image/png" />
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 30px auto;
      padding: 0 20px;
    }
    .baslik {
      font-size: 1.1em;
      margin-bottom: 10px;
    }
    .tarih {
      font-size: 0.9em;
      color: gray;
      margin-bottom: 20px;
    }
    #aramaKutusu {
      margin-bottom: 20px;
      width: 100%;
      padding: 8px;
      font-size: 1em;
      box-sizing: border-box;
    }
    #aramaButonu {
      padding: 8px 12px;
      font-size: 1em;
      cursor: pointer;
      margin-left: 5px;
    }
    a {
      color: black;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>

  <input type="text" id="aramaKutusu" placeholder="Başlık ara..." />
  <button id="aramaButonu">Ara</button>

  <div id="liste"></div>

  <script src="datas.js?v=2"></script>

  <script>
    const listeDiv = document.getElementById('liste');
    const aramaKutusu = document.getElementById('aramaKutusu');
    const aramaButonu = document.getElementById('aramaButonu');

    // Yeniye göre sırala (date descending)
    function tariheGoreSirala(liste) {
      return liste.slice().sort((a,b) => new Date(b.date) - new Date(a.date));
    }

    // Arama ile sırala (en çok eşleşen önce)
    function aramaylaSirala(liste, sorgu) {
      const q = sorgu.toLowerCase();
      function puanla(baslik) {
        let puan = 0, ti = 0;
        for (let qi = 0; qi < q.length; qi++) {
          while (ti < baslik.length && baslik[ti].toLowerCase() !== q[qi]) ti++;
          if (ti < baslik.length && baslik[ti].toLowerCase() === q[qi]) {
            puan++;
            ti++;
          } else break;
        }
        return puan;
      }

      return liste
        .map(makale => ({ makale, puan: puanla(makale.title) }))
        .filter(x => x.puan > 0)
        .sort((a, b) => b.puan - a.puan)
        .map(x => x.makale);
    }

    function listele(makaleler) {
      listeDiv.innerHTML = '';
      if (makaleler.length === 0) {
        listeDiv.innerHTML = '<p>Hiç makale bulunamadı.</p>';
        return;
      }
      makaleler.forEach((m, index) => {
        const link = document.createElement('a');
        link.href = `details.html?index=${index}`;
        link.target = '_blank';
        link.innerHTML = `
          <div class="baslik">${m.title}</div>
          <div class="tarih">${m.date}</div>
        `;
        listeDiv.appendChild(link);
      });
    }

    let guncelListe = tariheGoreSirala(articlesData);
    listele(guncelListe);

    aramaButonu.addEventListener('click', () => {
      const sorgu = aramaKutusu.value.trim();
      if (sorgu === '') {
        guncelListe = tariheGoreSirala(articlesData);
        listele(guncelListe);
      } else {
        const sonuc = aramaylaSirala(articlesData, sorgu);
        listele(sonuc);
      }
    });

    aramaKutusu.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') aramaButonu.click();
    });
  </script>

</body>
</html>
